---
phase: 1
plan: 2
wave: 1
---

# Plan 1.2: Local Storage & Backend SDK Configuration

## Objective
Set up Hive local storage (offline-first data layer) and the PocketBase client connection via Riverpod.

## Context
- .gsd/SPEC.md
- lib/core/ storage and network services

## Tasks

<task type="auto">
  <name>Initialize Hive</name>
  <files>lib/core/storage/hive_service.dart, lib/main.dart</files>
  <action>
    - Initialize `Hive.initFlutter()` in `main.dart`.
    - Set up a `HiveService` to manage opening required boxes: `userBox`, `foodLogBox`, `workoutLogBox`, `stepsBox`, `foodCacheBox`, `syncQueueBox`.
  </action>
  <verify>Launch the app and make sure there are no Hive initialisation errors.</verify>
  <done>Hive storage initializes successfully at startup.</done>
</task>

<task type="auto">
  <name>Setup PocketBase Client</name>
  <files>lib/core/network/pocketbase_client.dart</files>
  <action>
    - Create a singleton or Riverpod provider for the `PocketBase` client pointing to a dummy or local URL (e.g., `http://127.0.0.1:8090`).
    - Use `flutter_secure_storage` to persist the PocketBase AuthStore between sessions.
  </action>
  <verify>Code passes basic static analysis and Riverpod registers the client provider.</verify>
  <done>PocketBase client is initialized with secure persistent storage.</done>
</task>

## Success Criteria
- [ ] Hive boxes open without exceptions
- [ ] PocketBase SDK is accessible via Riverpod and persists login state
