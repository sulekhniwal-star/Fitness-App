---
phase: 6
plan: 5
wave: 3
depends_on: [3]
files_modified: [
  "fitkarma/lib/domain/services/voice_service.dart",
  "fitkarma/lib/presentation/widgets/voice_logging_sheet.dart",
  "fitkarma/lib/presentation/screens/food/food_logging_screen.dart"
]
autonomous: true

must_haves:
  truths:
    - "Users can log food or workouts by speaking in Hindi or English."
    - "Commands like 'Do roti' or 'Ek kela' are parsed into entries."
  artifacts:
    - "lib/domain/services/voice_service.dart"
---

# Plan 6.5: Voice-First Logging (Hindi/English)

<objective>
Streamline data entry for Indian users through intuitive voice commands in both English and Hindi.

Purpose: Reduce friction in daily logging, making the app easier to use for busy individuals.
Output: Integrated voice logging UI and NLP parsing logic.
</objective>

<context>
Load for context:
- fitkarma/pubspec.yaml (confirm speech_to_text)
- fitkarma/lib/data/providers/food_provider.dart
</context>

<tasks>

<task type="auto">
  <name>Speech-to-Text Integration</name>
  <files>lib/domain/services/voice_service.dart</files>
  <action>
    - Configure `speech_to_text` for multilingual support.
    - Implement a listener that detects "Log" keywords.
    - Setup TTS (Text-to-Speech) for confirmation feedback.
  </action>
  <verify>Voice input is correctly converted to text in both Hindi and English.</verify>
  <done>Speech recognition is functional.</done>
</task>

<task type="auto">
  <name>Keyword & Quantity Parser</name>
  <files>lib/domain/services/voice_service.dart</files>
  <action>
    - Build a regex-based parser for common Indian food quantities ("ek", "do", "aadha", "300g").
    - Map spoken food names to the local food database (OFF cache).
    - Map exercise names to workout categories.
  </action>
  <verify>Parsed commands correctly identify food items and quantities.</verify>
  <done>Natural language understanding for logging is ready.</done>
</task>

<task type="auto">
  <name>Voice Logging UI</name>
  <files>lib/presentation/widgets/voice_logging_sheet.dart</files>
  <action>
    - Design a floating "Voice Assistant" button or integrated mic icon.
    - Show a bottom sheet with real-time transcript and "Confirm/Edit" summary.
  </action>
  <verify>The voice logging flow is smooth and allows for manual correction.</verify>
  <done>Voice logging is fully integrated into the UI.</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] Saying "Do roti" correctly identifies 'Roti' with quantity 2.
- [ ] Saying "One banana" correctly identifies 'Banana' with quantity 1.
- [ ] Confirmations are read out via TTS if enabled.
</verification>

<success_criteria>
- [ ] All tasks verified
- [ ] Must-haves confirmed
</success_criteria>
