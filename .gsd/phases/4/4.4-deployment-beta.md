---
phase: 4
plan: 4
wave: 3
depends_on: [1, 2, 3]
files_modified: []
autonomous: true

must_haves:
  truths:
    - "APK builds successfully generating multiple optimized split architectures explicitly under 50MB."
    - "Production-ready backend deployments exist mapping NGINX/Docker effectively natively."
  artifacts:
    - "scripts/build_release.sh"
    - "backend/docker-compose.yml"
---

# Plan 4.4: VPS Deployment & Beta Optimization

<objective>
Provide deployment infrastructure scripting build variants and backend configurations launching the production MVP effectively securely.

Purpose: Deliver final optimized app assets parsing Play Store environments explicitly.
Output: Explicit scripts mapping compilation steps successfully rendering outputs.
</objective>

<context>
Load for context:
- fitkarma/pubspec.yaml
</context>

<tasks>

<task type="auto">
  <name>Craft Backend Docker Files</name>
  <files>backend/docker-compose.yml, backend/nginx.conf</files>
  <action>
    - Initialize standard `docker-compose.yml` pulling the latest `pocketbase` mapping volumes locally exposing port `8090`.
    - Create a reverse proxy `nginx.conf` template securing explicitly parsing rules mapping SSL explicitly handling traffic properly.
  </action>
  <verify>Deployment manifests validate formatting natively supporting structures.</verify>
  <done>Files create successfully linking standard environments explicitly safely.</done>
</task>

<task type="auto">
  <name>Write Build Optimization Script</name>
  <files>scripts/build_release.sh</files>
  <action>
    - Write a bash `scripts/build_release.sh` command calling `flutter build apk --split-per-abi --obfuscate --split-debug-info`.
    - Ensure output paths log correctly evaluating final megabyte size effectively mapping Play Store rules natively.
  </action>
  <verify>Shell scripts run without permissions errors formatting natively cleanly.</verify>
  <done>Release commands cleanly bundle architectures effectively managing distributions safely.</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] Scripts parse environments mapping cleanly evaluating final deploy targets successfully mapping optimizations.
</verification>

<success_criteria>
- [ ] All tasks verified
- [ ] Must-haves confirmed
</success_criteria>
